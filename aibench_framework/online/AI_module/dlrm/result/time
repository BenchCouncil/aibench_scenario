==28854== NVPROF is profiling process 28854, command: /home/cxlan26/ProgramFile/anaconda3/envs/dlrm/bin/python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=./input/train.txt --processed-dat
==28854== Execution timeout, stopping the application...
==28854== Profiling application: /home/cxlan26/ProgramFile/anaconda3/envs/dlrm/bin/python dlrm_s_pytorch.py --arch-sparse-feature-size=16 --arch-mlp-bot=13-512-256-64-16 --arch-mlp-top=512-256-1 --data-generation=dataset --data-set=kaggle --raw-data-file=./input/train.txt --processed-dat
==28854== Warning: 39426 records have invalid timestamps due to insufficient device buffer space. You can configure the buffer space using the option --device-buffer-size.
==28854== Warning: 5282 records have invalid timestamps due to insufficient semaphore pool size. You can configure the pool size using the option --profiling-semaphore-pool-size.
==28854== Profiling result:
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,s,,us,us,ms,
"GPU activities",18.954500,1.253805,47234,26.544000,1.088000,333.782314,"[CUDA memcpy HtoD]"
"GPU activities",7.480454,0.494818,153374,3.226000,3.103000,0.013216,"void at::native::_GLOBAL__N__59_tmpxft_0000103f_00000000_11_EmbeddingBag_compute_75_cpp1_ii_ad8c488d::EmbeddingBag_updateOutputKernel<float>(long*, at::native::_GLOBAL__N__59_tmpxft_0000103f_00000000_11_EmbeddingBag_compute_75_cpp1_ii_ad8c488d::EmbeddingBag_updateOutputKernel<float>, float*, float, at::native::_GLOBAL__N__59_tmpxft_0000103f_00000000_11_EmbeddingBag_compute_75_cpp1_ii_ad8c488d::EmbeddingBag_updateOutputKernel<float>, long, long, long, long, long, int, at::native::_GLOBAL__N__59_tmpxft_0000103f_00000000_11_EmbeddingBag_compute_75_cpp1_ii_ad8c488d::EmbeddingBag_updateOutputKernel<float>, at::native::_GLOBAL__N__59_tmpxft_0000103f_00000000_11_EmbeddingBag_compute_75_cpp1_ii_ad8c488d::EmbeddingBag_updateOutputKernel<float>, float, long)"
"GPU activities",6.533746,0.432195,306679,1.409000,1.343000,0.011839,"_ZN2at6native29vectorized_elementwise_kernelILi4EZNS0_23gpu_kernel_with_scalarsIZZZNS0_15mul_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE2_clEvEUlffE_EEvS4_RKT_EUlfE0_NS_6detail5ArrayIPcLi2EEEEEviT0_T1_"
"GPU activities",5.598971,0.370362,153357,2.415000,2.303000,0.010176,"void indexSelectLargeIndex<float, unsigned int, int=2, int=2, int=-2, bool=1>(TensorInfo<float, unsigned int>, TensorInfo<float, unsigned int>, TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)"
"GPU activities",5.553795,0.367373,153348,2.395000,2.272000,0.012992,"void at::native::indexAddLargeIndex<float, unsigned int, int=2, int=2, int=-2, bool=1>(at::cuda::detail::TensorInfo<float, unsigned int>, unsigned int, at::cuda::detail<long, float>, int, int, float, float, long)"
"GPU activities",4.856437,0.321244,165136,1.945000,1.343000,0.010751,"_ZN2at6native29vectorized_elementwise_kernelILi4EZZZNS0_15add_kernel_cudaERNS_14TensorIteratorEN3c106ScalarEENKUlvE_clEvENKUlvE2_clEvEUlffE_NS_6detail5ArrayIPcLi3EEEEEviT0_T1_"
"GPU activities",4.270387,0.282478,35390,7.981000,4.640000,0.012512,"_ZN2at6native13reduce_kernelILi128ELi4ENS0_8ReduceOpIfNS0_14func_wrapper_tIfZNS0_15sum_kernel_implIfffEEvRNS_14TensorIteratorEEUlffE_EEjfLi4EEEEEvT1_"
"GPU activities",3.900418,0.258005,171028,1.508000,1.248000,0.010880,"[CUDA memcpy DtoD]"
"GPU activities",3.567353,0.235974,23593,10.001000,7.552000,0.015136,"volta_sgemm_32x32_sliced1x4_nt"
"GPU activities",3.206855,0.212128,17696,11.987000,9.792000,0.013888,"volta_sgemm_64x32_sliced1x4_nn"
"GPU activities",3.048056,0.201623,5899,34.179000,32.927000,0.035423,"void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__merge_sort::BlockSortAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, long, ThrustLTOp<long, bool=0>, thrust::detail::integral_constant<bool, bool=1>, thrust::detail::integral_constant<bool, bool=0>>, bool, thrust::device_ptr<long>, thrust::device_ptr<long>, long, long*, long*, ThrustLTOp<long, bool=0>>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, long, bool=0, ThrustLTOp<long, bool=0>, bool)"
"GPU activities",2.590864,0.171381,47192,3.631000,2.176000,0.011744,"_ZN2at6native27unrolled_elementwise_kernelIZZZNS0_21copy_device_to_deviceERNS_14TensorIteratorEbENKUlvE0_clEvENKUlvE2_clEvEUlfE_NS_6detail5ArrayIPcLi2EEE16OffsetCalculatorILi1EjESC_NS0_6memory15LoadWithoutCastENSD_16StoreWithoutCastEEEviT_T0_T1_T2_T3_T4_"
"GPU activities",2.344127,0.155060,17697,8.761000,8.000000,0.011936,"volta_sgemm_128x32_tn"
"GPU activities",2.140121,0.141565,5899,23.998000,23.775000,0.024640,"void _GLOBAL__N__55_tmpxft_0000122f_00000000_11_Indexing_compute_75_cpp1_ii_09181334::indexing_backward_kernel<float, int=4>(long*, _GLOBAL__N__55_tmpxft_0000122f_00000000_11_Indexing_compute_75_cpp1_ii_09181334::indexing_backward_kernel<float, int=4>, float*, float, long, long, long, long)"
"GPU activities",2.126188,0.140643,100269,1.402000,1.055000,0.012032,"_ZN2at6native29vectorized_elementwise_kernelILi4EZZZNS0_16fill_kernel_cudaERNS_14TensorIteratorEN3c106ScalarEENKUlvE_clEvENKUlvE2_clEvEUlvE_NS_6detail5ArrayIPcLi1EEEEEviT0_T1_"
"GPU activities",2.012555,0.133127,70784,1.880000,1.376000,0.010784,"_ZN2at6native29vectorized_elementwise_kernelILi4EZNS0_21threshold_kernel_implIfEEvRNS_14TensorIteratorET_S5_EUlffE_NS_6detail5ArrayIPcLi3EEEEEviT0_T1_"
"GPU activities",2.003153,0.132505,11797,11.232000,9.631000,0.013440,"volta_sgemm_64x32_sliced1x4_nt"
"GPU activities",1.886005,0.124756,41292,3.021000,2.016000,0.011328,"void splitKreduce_kernel<float, float, float>(cublasSplitKParams<float>, float const *, float const *, float*, float const *, float const *)"
"GPU activities",1.763735,0.116668,5899,19.777000,18.719000,0.020512,"volta_sgemm_128x64_nt"
"GPU activities",1.746004,0.115495,5899,19.578000,18.880000,0.020288,"volta_sgemm_128x64_nn"
"GPU activities",1.569038,0.103789,11798,8.797000,5.663000,0.013024,"volta_sgemm_32x32_sliced1x4_tn"
"GPU activities",1.505716,0.099600,5899,16.884000,16.224000,0.017952,"volta_sgemm_128x64_tn"
"GPU activities",1.300953,0.086056,5899,14.588000,13.855000,0.017376,"volta_sgemm_32x128_tn"
"GPU activities",1.084240,0.071720,5898,12.160000,11.519000,0.013311,"volta_sgemm_32x32_sliced1x4_nn"
"GPU activities",1.045064,0.069129,11798,5.859000,2.079000,0.013248,"void at::native::_GLOBAL__N__52_tmpxft_000019bc_00000000_11_Shape_compute_75_cpp1_ii_cedd8df2::CatArrayBatchedCopy<float, unsigned int, int=2>(float*, at::native::_GLOBAL__N__52_tmpxft_000019bc_00000000_11_Shape_compute_75_cpp1_ii_cedd8df2::CatArrInputTensor<at::native::_GLOBAL__N__52_tmpxft_000019bc_00000000_11_Shape_compute_75_cpp1_ii_cedd8df2::CatArrayBatchedCopy<float, unsigned int, int=2>, unsigned int>*, at::native::_GLOBAL__N__52_tmpxft_000019bc_00000000_11_Shape_compute_75_cpp1_ii_cedd8df2::OutputTensorSizeStride<at::native::_GLOBAL__N__52_tmpxft_000019bc_00000000_11_Shape_compute_75_cpp1_ii_cedd8df2::CatArrInputTensor, unsigned int=4>, int, at::native::_GLOBAL__N__52_tmpxft_000019bc_00000000_11_Shape_compute_75_cpp1_ii_cedd8df2::CatArrInputTensor)"
"GPU activities",0.929337,0.061474,11798,5.210000,2.879000,0.008288,"_ZN2at6native27unrolled_elementwise_kernelIZZZNS0_15add_kernel_cudaERNS_14TensorIteratorEN3c106ScalarEENKUlvE_clEvENKUlvE2_clEvEUlffE_NS_6detail5ArrayIPcLi3EEE16OffsetCalculatorILi2EjESD_ILi1EjENS0_6memory15LoadWithoutCastENSG_16StoreWithoutCastEEEviT_T0_T1_T2_T3_T4_"
"GPU activities",0.736489,0.048717,5898,8.259000,7.872000,0.009248,"volta_sgemm_128x32_nn"
"GPU activities",0.681849,0.045103,5899,7.645000,7.104000,0.011584,"_ZN2at6native24index_elementwise_kernelILi128ELi4EZNS0_16gpu_index_kernelIZNS0_17index_kernel_implINS0_10OpaqueTypeILi4EEEEEvRNS_14TensorIteratorEN3c108ArrayRefIlEESA_EUlPcSB_lE_EEvS7_SA_SA_RKT_EUliE_EEviT1_"
"GPU activities",0.551604,0.036488,5899,6.185000,5.951000,0.009920,"_ZN2at6native13reduce_kernelILi512ELi1ENS0_8ReduceOpIfNS0_14func_wrapper_tIfZNS0_15sum_kernel_implIfffEEvRNS_14TensorIteratorEEUlffE_EEjfLi4EEEEEvT1_"
"GPU activities",0.548534,0.036285,5899,6.150000,5.951000,0.006816,"void at::native::reduce_kernel<int=512, int=1, at::native::ReduceOp<float, at::native::MeanOps<float, float>, unsigned int, float, int=4>>(float)"
"GPU activities",0.524408,0.034689,11798,2.940000,1.952000,0.007808,"_ZN2at6native29vectorized_elementwise_kernelILi4EZNS0_23gpu_kernel_with_scalarsIZZZNS0_21remainder_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE2_clEvEUlllE_EEvS4_RKT_EUllE0_NS_6detail5ArrayIPcLi2EEEEEviT0_T1_"
"GPU activities",0.522398,0.034556,5899,5.857000,5.599000,0.010400,"_ZN2at6native27unrolled_elementwise_kernelIZZZZN75_GLOBAL__N__51_tmpxft_000012f7_00000000_11_Loss_compute_75_cpp1_ii_5c69dde640binary_cross_entropy_backward_out_kernelERNS_6TensorERKS3_S6_S6_ENKUlvE_clEvENKUlvE0_clEvENKUlvE_clEvEUlfffE_NS_6detail5ArrayIPcLi4EEE16OffsetCalculatorILi3EjESF_ILi1EjENS0_6memory15LoadWithoutCastENSI_16StoreWithoutCastEEEviT_T0_T1_T2_T3_T4_"
"GPU activities",0.451817,0.029887,5899,5.066000,4.831000,0.006975,"_ZN2at6native29vectorized_elementwise_kernelILi4EZZZZNS0_29binary_cross_entropy_out_cudaERNS_6TensorERKS2_S5_S5_lENKUlvE_clEvENKUlvE0_clEvENKUlvE_clEvEUlffE_NS_6detail5ArrayIPcLi3EEEEEviT0_T1_"
"GPU activities",0.444995,0.029436,5899,4.989000,4.544000,0.007072,"void gemv2T_kernel_val<int, int, float, float, float, int=128, int=16, int=4, int=4, bool=0, cublasGemvParams<cublasGemvTensorStridedBatched<float const >, cublasGemvTensorStridedBatched<float>, float>>(float const , float, float)"
"GPU activities",0.338569,0.022396,5899,3.796000,3.487000,0.006944,"void gemvNSP_kernel<float, float, float, int=1, int=16, int=4, int=1024, cublasGemvParams<cublasGemvTensorStridedBatched<float const >, cublasGemvTensorStridedBatched<float>, float>>(float const )"
"GPU activities",0.324813,0.021486,5899,3.642000,3.487000,0.008832,"_ZN2at6native29vectorized_elementwise_kernelILi4EZZZZNS0_19sigmoid_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE0_clEvENKUlvE_clEvEUlfE_NS_6detail5ArrayIPcLi2EEEEEviT0_T1_"
"GPU activities",0.324741,0.021481,11798,1.820000,1.407000,0.006656,"_ZN2at6native29vectorized_elementwise_kernelILi4EZNS0_23gpu_kernel_with_scalarsIZZZNS0_15mul_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE4_clEvEUlllE_EEvS4_RKT_EUllE0_NS_6detail5ArrayIPcLi2EEEEEviT0_T1_"
"GPU activities",0.316083,0.020908,5899,3.544000,3.360000,0.006112,"_ZN2at6native29vectorized_elementwise_kernelILi4EZNS0_23gpu_kernel_with_scalarsIZZZNS0_15div_kernel_cudaERNS_14TensorIteratorEENKUlvE0_clEvENKUlvE4_clEvEUlllE_EEvS4_RKT_EUllE0_NS_6detail5ArrayIPcLi2EEEEEviT0_T1_"
"GPU activities",0.276955,0.018320,5899,3.105000,2.720000,0.007104,"void gemmk1_kernel<float, int=256, int=5, bool=0, bool=0, bool=1, bool=0, cublasGemvTensorStridedBatched<float const >, cublasGemvTensorStridedBatched<float>, float>(cublasGemmk1Params<float, float const , cublasGemvTensorStridedBatched<float const >, float>)"
"GPU activities",0.242171,0.016019,11798,1.357000,1.056000,0.002367,"[CUDA memcpy DtoH]"
"GPU activities",0.222367,0.014709,5899,2.493000,2.240000,0.007072,"_ZN2at6native29vectorized_elementwise_kernelILi4EZZZNS0_15add_kernel_cudaERNS_14TensorIteratorEN3c106ScalarEENKUlvE_clEvENKUlvE4_clEvEUlllE_NS_6detail5ArrayIPcLi3EEEEEviT0_T1_"
"GPU activities",0.185377,0.012262,5899,2.078000,1.983000,0.009216,"_ZN2at6native29vectorized_elementwise_kernelILi4EZZZZNS0_28sigmoid_backward_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE0_clEvENKUlvE_clEvEUlffE_NS_6detail5ArrayIPcLi3EEEEEviT0_T1_"
"GPU activities",0.161229,0.010665,5899,1.807000,1.696000,0.004640,"_ZN2at6native29vectorized_elementwise_kernelILi4EZZZNS0_15div_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE0_clEvEUlfE_NS_6detail5ArrayIPcLi2EEEEEviT0_T1_"
"GPU activities",0.127530,0.008436,5899,1.430000,1.376000,0.006304,"void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__parallel_for::ParallelForAgent<thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>, thrust::cuda_cub::__transform::unary_transform_f<thrust::counting_iterator<long, thrust::use_default, thrust::use_default, thrust::use_default>, thrust::device_ptr<long>, thrust::cuda_cub::__transform::no_stencil_tag, thrust::identity<long>, thrust::cuda_cub::__transform::always_true_predicate>, long>(thrust::use_default, thrust::use_default)"
"API calls",39.458601,33.820163,1520514,22.242000,6.550000,95.943576,"cudaLaunchKernel"
"API calls",25.689054,22.018216,21,1048486.480000,12.520000,22009.352001,"cudaMalloc"
"API calls",18.228667,15.623881,22059977,0.708000,0.267000,19.082500,"cudaGetDevice"
"API calls",11.466155,9.827699,235340,41.759000,7.403000,334.106376,"cudaMemcpyAsync"
"API calls",2.065288,1.770168,6,295028.058000,2.360000,1281.759438,"cudaFree"
"API calls",0.836387,0.716872,1586862,0.451000,0.111000,2.132565,"cudaGetLastError"
"API calls",0.765577,0.656179,60380,10.867000,2.526000,3.556986,"cudaStreamSynchronize"
"API calls",0.378340,0.324277,54305,5.971000,2.897000,4.892359,"cudaEventQuery"
"API calls",0.368330,0.315697,120680,2.615000,0.897000,1.132914,"cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags"
"API calls",0.242295,0.207673,30170,6.883000,2.944000,3.875346,"cudaFuncGetAttributes"
"API calls",0.171385,0.146895,54306,2.704000,1.260000,0.685130,"cudaEventRecord"
"API calls",0.164266,0.140794,12069,11.665000,6.261000,0.754487,"cudaDeviceSynchronize"
"API calls",0.038339,0.032860,12067,2.723000,1.426000,0.022102,"cudaEventDestroy"
"API calls",0.038132,0.032683,36226,0.902000,0.349000,0.030331,"cudaDeviceGetAttribute"
"API calls",0.037060,0.031764,12104,2.624000,0.845000,0.017810,"cudaEventCreateWithFlags"
"API calls",0.025260,0.021650,24138,0.896000,0.316000,0.389331,"cudaSetDevice"
"API calls",0.011037,0.009460,24136,0.391000,0.140000,0.746224,"cudaPeekAtLastError"
"API calls",0.010686,0.009159,3,3053.006000,2953.575000,3.198087,"cuDeviceTotalMem"
"API calls",0.002145,0.001839,1,1838.779000,1838.779000,1.838779,"cudaHostAlloc"
"API calls",0.001171,0.001004,2,501.918000,207.588000,0.796249,"cudaGetDeviceProperties"
"API calls",0.000788,0.000676,285,2.370000,0.325000,0.075596,"cuDeviceGetAttribute"
"API calls",0.000335,0.000287,3,95.687000,43.143000,0.194759,"cuDeviceGetName"
"API calls",0.000280,0.000240,180,1.331000,0.555000,0.014068,"cudaFuncSetAttribute"
"API calls",0.000255,0.000219,38,5.753000,0.267000,0.179366,"cudaGetDeviceCount"
"API calls",0.000125,0.000107,2,53.444000,42.370000,0.064519,"cudaMemcpy"
"API calls",0.000010,0.000008,2,4.245000,2.523000,0.005967,"cuDeviceGetPCIBusId"
"API calls",0.000008,0.000007,5,1.423000,0.660000,0.002478,"cuDeviceGetCount"
"API calls",0.000008,0.000007,1,6.750000,6.750000,0.006750,"cuDevicePrimaryCtxGetState"
"API calls",0.000005,0.000005,4,1.175000,0.580000,0.002616,"cuDeviceGet"
"API calls",0.000005,0.000004,2,2.233000,2.230000,0.002236,"cuInit"
"API calls",0.000004,0.000003,2,1.721000,1.603000,0.001840,"cuDriverGetVersion"
"API calls",0.000002,0.000002,3,0.526000,0.513000,0.000548,"cuDeviceGetUuid"

==28854== System profiling result:
"","Device","Count","Avg","Min","Max"
"SM Clock (MHz)","Tesla V100-PCIE-32GB (0)",6095,837.942412,135.000000,1380.000000
"Memory Clock (MHz)","Tesla V100-PCIE-32GB (0)",6095,877.000000,877.000000,877.000000
"Temperature (C)","Tesla V100-PCIE-32GB (0)",12190,26.739295,24.000000,29.000000
"Power (mW)","Tesla V100-PCIE-32GB (0)",12190,35501.773421,23187.000000,49462.000000
==28854== Warning: Some profiling data are not recorded. Make sure cudaProfilerStop() or cuProfilerStop() is called before application exit to flush profile data.
